pipeline:
  build:
    image: adoptopenjdk/maven-openjdk11
    pull: true
    commands:
      - mvn clean
      - mvn install
      - mvn package
    when:
      branch: [ master, develop ]
      event: push
      
  rebuild-cache:
    image: drillster/drone-volume-cache
    rebuild: true
    mount:
      - ./
    volumes:
      - /tmp/cache:/cache
    ttl: 7
    when:
      branch: [ master, develop ]
      event: push
  deploy:
    image: plugins/docker
    dockerfile: Dockerfile
    
services:
  drone_mariadb:
    image: mariadb:latest
  